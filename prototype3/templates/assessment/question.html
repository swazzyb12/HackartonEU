{% extends "base.html" %} {% block title %}Question {{ current_question + 1 }}
of {{ total_questions }} - CyberHubs{% endblock %} {% block content %}
<div class="max-w-5xl mx-auto px-4">
  <!-- Progress Bar -->
  <div class="mb-6 fade-in">
    <div class="flex justify-between items-center mb-2">
      <span class="text-slate-300 font-medium"
        >Question {{ current_question + 1 }} of {{ total_questions }}</span
      >
      <span class="text-slate-300 font-medium"
        >{{ ((current_question / total_questions) * 100)|round }}%
        Complete</span
      >
    </div>
    <div class="w-full bg-slate-700 rounded-full h-3 overflow-hidden">
      <div
        class="bg-gradient-to-r from-cyan-500 to-blue-500 h-full transition-all duration-500"
        style="width: {{ (current_question / total_questions) * 100 }}%"
      ></div>
    </div>
  </div>

  <!-- Domain & Difficulty Badge -->
  <div class="flex gap-3 mb-6 fade-in" style="animation-delay: 0.1s">
    <span
      class="px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-cyan-400 font-medium flex items-center gap-2"
    >
      <svg
        class="w-5 h-5"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"
        ></path>
      </svg>
      {{ question.domain|replace('-', ' ')|title }}
    </span>
    <span
      class="px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg font-medium flex items-center gap-2 {% if question.difficulty == 'beginner' %}text-green-400 border-green-500/30{% elif question.difficulty == 'intermediate' %}text-yellow-400 border-yellow-500/30{% else %}text-red-400 border-red-500/30{% endif %}"
    >
      <svg
        class="w-5 h-5"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"
        ></path>
      </svg>
      {% if question.difficulty == 'beginner' %}ðŸŒ±{% elif question.difficulty
      == 'intermediate' %}âš¡{% else %}ðŸ”¥{% endif %} {{
      question.difficulty|title }}
    </span>
    <!-- Adaptive Mode Indicator -->
    <span
      class="px-4 py-2 bg-purple-500/10 border border-purple-500/30 rounded-lg text-purple-400 font-medium flex items-center gap-2"
      title="Difficulty adapts based on your performance"
    >
      <svg
        class="w-5 h-5 animate-pulse"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M13 10V3L4 14h7v7l9-11h-7z"
        ></path>
      </svg>
      Adaptive
    </span>
  </div>
      {{ question.domain|replace('-', ' ')|title }}
    </span>
    <span
      class="px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg {% if question.difficulty == 'beginner' %}text-green-400{% elif question.difficulty == 'intermediate' %}text-yellow-400{% else %}text-red-400{% endif %} font-medium flex items-center gap-2"
    >
      <svg
        class="w-5 h-5"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"
        ></path>
      </svg>
      {{ question.difficulty|title }}
    </span>
  </div>

  <!-- Question Card -->
  <div
    class="bg-slate-800 rounded-xl p-8 border border-slate-700 mb-6 fade-in"
    style="animation-delay: 0.2s"
  >
    <h2 class="text-2xl font-bold text-white mb-6">{{ question.question }}</h2>

    {# Moved: Show context directly under the question #}
    {% if question.context %}
    <div class="mb-6">
      <div class="flex items-start gap-3">
        <svg
          class="w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
          ></path>
        </svg>
        <div>
          <h3 class="text-white font-semibold mb-1">Context</h3>
          <p class="text-slate-300 text-sm whitespace-pre-wrap">
            {{ question.context }}
          </p>
        </div>
      </div>
    </div>
    {% endif %}

    

    <form
      method="POST"
      action="{{ url_for('assessment.question') }}"
      id="questionForm"
      class="space-y-4"
    >
      <input type="hidden" name="question_id" value="{{ question_id }}" />
      <input type="hidden" name="start_time" value="{{ start_time }}" />

      {% for option in question.options %}
      <label class="relative cursor-pointer block">
        <input
          type="radio"
          name="answer"
          value="{{ loop.index0 }}"
          class="peer sr-only"
          required
        />
        <div
          class="bg-slate-700 border-2 border-slate-600 rounded-lg p-5 hover:border-cyan-500 peer-checked:border-cyan-500 peer-checked:bg-cyan-500/10 transition"
        >
          <div class="flex items-start gap-4">
            <div
              class="flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center font-bold text-white transition bg-slate-600 border-2 border-transparent peer-checked:bg-cyan-500 peer-checked:border-cyan-300 peer-checked:ring-2 peer-checked:ring-cyan-400 peer-checked:ring-offset-2 peer-checked:ring-offset-slate-700"
            >
              {{ ['A', 'B', 'C', 'D'][loop.index0] }}
            </div>
            <p class="text-white flex-1 pt-1">{{ option }}</p>
          </div>
        </div>
      </label>
      {% endfor %}

      <div class="flex gap-4 pt-6">
        {% if current_question > 0 %}
        <a
          href="{{ url_for('assessment.question') }}?previous=true"
          class="flex-1 bg-slate-700 hover:bg-slate-600 text-white font-bold py-4 px-6 rounded-lg transition text-center flex items-center justify-center gap-2"
        >
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M15 19l-7-7 7-7"
            ></path>
          </svg>
          Previous
        </a>
        {% endif %}

        <button
          type="submit"
          class="{% if current_question > 0 %}flex-1{% else %}w-full{% endif %} bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 text-white font-bold py-4 px-6 rounded-lg transition transform hover:scale-105 flex items-center justify-center gap-2"
        >
          {% if current_question < total_questions - 1 %} Next Question
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 5l7 7-7 7"
            ></path>
          </svg>
          {% else %} Complete Assessment
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M5 13l4 4L19 7"
            ></path>
          </svg>
          {% endif %}
        </button>
      </div>
    </form>
  </div>

</div>

<script>
  console.log('Question page loaded:', {
      questionId: '{{ question_id }}',
      currentQuestion: {{ current_question }},
      totalQuestions: {{ total_questions }},
      domain: '{{ question.domain }}',
      difficulty: '{{ question.difficulty }}'
  });

  // Auto-scroll to top on load
  window.scrollTo(0, 0);

  // Form validation
  document.getElementById('questionForm').addEventListener('submit', function(e) {
      const selected = document.querySelector('input[name="answer"]:checked');
      if (!selected) {
          e.preventDefault();
          alert('Please select an answer before continuing.');
      }
  });
</script>
{% endblock %}
